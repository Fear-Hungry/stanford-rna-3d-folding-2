experiment_name: rna3d_kaggle_loop_template
solver:
  type: command_json
  timeout_s: 600
  command:
    - python
    - -c
    - |
      import json
      from pathlib import Path

      run_dir = Path("{run_dir}")
      run_dir.mkdir(parents=True, exist_ok=True)

      # Template smoke: substitua este bloco pelo pipeline real
      # (retrieve/predict/export/score) para uso competitivo.
      sample = run_dir / "sample_submission.csv"
      sub = run_dir / "submission.csv"
      score = run_dir / "score.json"

      sample.write_text(
          "ID,resname,resid,x_1,y_1,z_1\n"
          "T1_1,A,1,0,0,0\n",
          encoding="utf-8",
      )
      sub.write_text(
          "ID,resname,resid,x_1,y_1,z_1\n"
          "T1_1,A,1,0.1,0.2,0.3\n",
          encoding="utf-8",
      )
      score.write_text(json.dumps({"score": 0.201}), encoding="utf-8")

      print(json.dumps({
          "instance_id": "rna3d_proxy_seed_{seed}",
          "solver_status": "success",
          "objective": 0.201,
          "feasible": True,
          "gap": 0.0,
      }))
seeds: [123]
required_outputs:
  - "{run_dir}/sample_submission.csv"
  - "{run_dir}/submission.csv"
  - "{run_dir}/score.json"
kaggle_gate:
  sample_submission: "{run_dir}/sample_submission.csv"
  submission: "{run_dir}/submission.csv"
  score_json: "{run_dir}/score.json"
  baseline_score: 0.200
  min_improvement: 0.0005
  max_submission_mb: 50
  max_runtime_s_per_seed: 600
repro_command:
  - python
  - -m
  - rna3d_local
  - research-run
  - --config
  - "{repo_root}/configs/research/problems/rna3d_kaggle_loop.yaml"
  - --run-id
  - "{run_id}"
  - --allow-existing-run-dir
